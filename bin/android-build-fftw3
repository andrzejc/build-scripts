#! /usr/bin/env bash
set -e -o pipefail
set +x
# optional dependencies:
THIS_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
SOURCE_URL="${SOURCE_URL:=http://www.fftw.org/fftw-3.3.9.tar.gz}"

function run_configure() {
    local opts
    case "${TARGET}" in
    armv7a-*|aarch64-*)
        [[ ! "$@" =~ "--enable-single" ]] || opts+=(--enable-neon)
        ;;
    *)
        [[ "$@" =~ "--enable-long-double" ]] || opts+=(--enable-sse2)
        ;;
    esac
    ./configure "$@" "${opts[@]}"
}

function build_target() {
    build_target_default "$@"
    build_target_default --enable-single "$@"
    build_target_default --enable-long-double "$@"
}

source "${THIS_DIR}/android-autotools-build.sh" \
    --enable-threads \
    --disable-fortran
