#!/usr/bin/env bash
set -eu
set -o pipefail

function get_windows_program_files_dir {
    local target_platform="$1"
    local system_drive="${SystemDrive:-c:}"
    system_drive="${system_drive%:}"
    case "${target_platform}" in
    *64)
        echo "/${system_drive}/Program Files" ;;
    *32|*86)
        if [[ "${PROCESSOR_ARCHITECTURE}" =~ 64$ || "${PROCESSOR_ARCHITEW6432}" =~ 64$ ]]; then
            echo "/${system_drive}/Program Files (x86)"
        else
            echo "/${system_drive}/Program Files"
        fi
        ;;
    *)
        >&2 echo "get-windows-program-files-dir: unknown target platform $1"
        return 1 ;;
    esac
}

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    get_windows_program_files_dir "$@"
fi
